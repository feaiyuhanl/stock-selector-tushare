# 评分指标说明

本文档详细说明程序的评分体系，包括评分维度、计算公式、缺失处理等。

## 目录

- [评分体系概述](#评分体系概述)
- [各维度详细说明](#各维度详细说明)
- [综合评分计算](#综合评分计算)
- [缺失指标处理](#缺失指标处理)
- [分数范围与等级](#分数范围与等级)

---

## 评分体系概述

程序采用**多维度加权评分**体系，总评分 = Σ(各维度得分 × 对应权重)

### 评分特点

- **多维度评分**：综合考虑基本面、成交量、成交价格三个维度
- **子维度细化**：每个大维度下包含多个子维度，评分更加精准
- **权重可配置**：支持自定义各维度权重，灵活调整选股策略
- **智能容错**：自动处理缺失指标，根据数据可用性动态调整权重

### 评分规则

- **各维度得分范围**：0-100分
- **所有权重总和**：1.0（或100%）
- **最终得分范围**：0-100分

---

## 各维度详细说明

### 1. 基本面评分（权重：40%）

基本面评分综合考虑公司的估值、盈利能力、成长性等指标。

#### PE市盈率（权重20%）

- **评估方法**：静态市盈率，越低估值越合理
- **评分标准**：
  - PE ≤ 20：100分（合理估值）
  - 20 < PE ≤ 30：80分（略高估值）
  - 30 < PE ≤ 50：60分（较高估值）
  - PE > 50：60 - (PE-50)×2分，递减至0分
  - PE = 0：40分（亏损股）
  - 无数据：50分（默认中等分）

#### PB市净率（权重20%）

- **评估方法**：市净率，越低越有投资价值
- **评分标准**：
  - PB ≤ 1.0：100分（低估）
  - 1.0 < PB ≤ 2.0：80分（合理）
  - 2.0 < PB ≤ 3.0：60分（略高）
  - 3.0 < PB ≤ 5.0：40分（较高）
  - PB > 5.0：40 - (PB-5)×5分，递减至0分
  - PB = 0：40分（特殊情况）
  - 无数据：50分（默认中等分）

#### ROE净资产收益率（权重25%）

- **评估方法**：净资产收益率，衡量盈利能力
- **评分标准**：
  - ROE ≥ 20%：100分（优秀）
  - 15% ≤ ROE < 20%：85分（良好）
  - 10% ≤ ROE < 15%：70分（中等）
  - 5% ≤ ROE < 10%：50分（一般）
  - ROE < 5%：50 + ROE×2分，递减至0分
  - 无数据：50分（默认中等分）

#### 营收增长率（权重20%）

- **评估方法**：营业收入同比增长率，衡量成长性
- **评分标准**：
  - 增长率 ≥ 50%：100分（高速增长）
  - 30% ≤ 增长率 < 50%：85分（稳步增长）
  - 15% ≤ 增长率 < 30%：70分（温和增长）
  - 0% ≤ 增长率 < 15%：50分（缓慢增长）
  - 增长率 < 0%：50 + 增长率分，递减至0分
  - 无数据：50分（默认中等分）

#### 利润增长率（权重15%）

- **评估方法**：净利润同比增长率，衡量盈利增长能力
- **评分标准**：与营收增长率相同
  - 增长率 ≥ 50%：100分（高速增长）
  - 30% ≤ 增长率 < 50%：85分（稳步增长）
  - 15% ≤ 增长率 < 30%：70分（温和增长）
  - 0% ≤ 增长率 < 15%：50分（缓慢增长）
  - 增长率 < 0%：50 + 增长率分，递减至0分
  - 无数据：50分（默认中等分）

### 2. 成交量评分（权重：30%）

成交量评分评估股票的交易活跃度和成交量趋势。

#### 量比（权重40%）

- **评估方法**：当前成交量与历史平均成交量的比值
- **计算公式**：量比 = 今日成交量 ÷ 历史平均成交量
- **评分标准**：
  - 1.5 ≤ 量比 ≤ 3.0：100分（适度放量）
  - 1.2 ≤ 量比 < 1.5 或 3.0 < 量比 ≤ 4.0：80分（温和放量）
  - 1.0 ≤ 量比 < 1.2 或 4.0 < 量比 ≤ 5.0：60分（轻度放量/缩量）
  - 量比 < 1.0：40 + 量比×20分，递减至0分（缩量）
  - 量比 > 5.0：60 - (量比-5)×5分，递减至0分（过度放量）
  - 无数据：50分（默认中等分）

#### 换手率（权重30%）

- **评估方法**：换手率反映股票流动性，越高表示越活跃
- **评分标准**：
  - 2% ≤ 换手率 ≤ 10%：100分（适度活跃）
  - 1% ≤ 换手率 < 2% 或 10% < 换手率 ≤ 15%：80分（温和活跃）
  - 0.5% ≤ 换手率 < 1% 或 15% < 换手率 ≤ 20%：60分（偏低/偏高活跃度）
  - 其他范围：40分（流动性不足或过度活跃）
  - 无数据：50分（默认中等分）

#### 成交量趋势（权重30%）

- **评估方法**：短期成交量均值与长期成交量均值的比值
- **计算公式**：成交量趋势 = 短期均量(5日) ÷ 长期均量(20日)
- **评分标准**：
  - 趋势 ≥ 1.2：100分（明显放量上涨）
  - 1.1 ≤ 趋势 < 1.2：85分（温和放量上涨）
  - 1.0 ≤ 趋势 < 1.1：70分（平稳上涨）
  - 0.9 ≤ 趋势 < 1.0：50分（震荡调整）
  - 趋势 < 0.9：递减至30分（缩量下跌）
  - 无数据：50分（默认中等分）

### 3. 价格评分（权重：30%）

价格评分评估股票的价格趋势、相对位置和波动性。

#### 价格趋势（权重35%）

- **评估方法**：比较短期均线与长期均线的关系，判断价格走势
- **计算公式**：
  - 短期均线 = 最近5日收盘价平均值
  - 长期均线 = 最近20日收盘价平均值
  - 趋势强度 = 短期均线 ÷ 长期均线
- **评分标准**：
  - 趋势强度 ≥ 1.05 且 当前价 ≥ 短期均线：100分（强势上涨）
  - 趋势强度 ≥ 1.02 且 当前价 ≥ 短期均线：85分（温和上涨）
  - 趋势强度 ≥ 1.0：70分（震荡上行）
  - 趋势强度 ≥ 0.98：50分（震荡下行）
  - 其他情况：≤30分（下跌趋势）
- **数据要求**：至少20日数据，少于20日使用简化算法
- **无数据处理**：50分（默认中等分）

#### 价格位置（权重30%）

- **评估方法**：判断当前价格在近期区间内的相对位置，避免追高和过度抄底
- **计算公式**：
  - 最高价 = 最近20日最高价
  - 最低价 = 最近20日最低价
  - 位置比率 = (当前价 - 最低价) ÷ (最高价 - 最低价)
- **评分标准**：
  - 30% ≤ 位置比率 ≤ 70%：100分（适中位置，较安全）
  - 20% ≤ 位置比率 < 30% 或 70% < 位置比率 ≤ 80%：80分（较高位置）
  - 10% ≤ 位置比率 < 20% 或 80% < 位置比率 ≤ 90%：60分（很高位置）
  - 其他范围：40分（极高/极低位置，风险较大）
- **数据要求**：至少20日数据
- **无数据处理**：50分（默认中等分）

#### 波动率（权重35%）

- **评估方法**：计算价格波动的标准差，年化后评估稳定性
- **计算公式**：
  - 日收益率 = (当日收盘价 - 前日收盘价) ÷ 前日收盘价
  - 年化波动率 = 日收益率标准差 × √252（252个交易日）
- **评分标准**：
  - 20% ≤ 年化波动率 ≤ 40%：100分（适度波动，风险可控）
  - 15% ≤ 年化波动率 < 20% 或 40% < 年化波动率 ≤ 50%：80分（较高波动）
  - 10% ≤ 年化波动率 < 15% 或 50% < 年化波动率 ≤ 60%：60分（很高波动）
  - 其他范围：≤40分（极高/极低波动，不利于投资）
- **数据要求**：至少10日数据
- **无数据处理**：50分（默认中等分）

---

## 综合评分计算

### 加权计算公式

**总评分 = Σ(各子维度得分 × 对应权重)**

以默认权重配置为例：
```
总评分 = 基本面得分×40% + 成交量得分×30% + 价格得分×30%
```

### 子维度得分计算

每个大维度得分 = Σ(子维度得分 × 子维度权重)

- **基本面得分** = PE得分×20% + PB得分×20% + ROE得分×25% + 营收增长得分×20% + 利润增长得分×15%
- **成交量得分** = 量比得分×40% + 换手率得分×30% + 成交量趋势得分×30%
- **价格得分** = 价格趋势得分×35% + 价格位置得分×30% + 波动率得分×35%

### 计算示例

假设某只股票的评分如下：

- 基本面评分：80分
  - PE得分：90分（权重20%）
  - PB得分：85分（权重20%）
  - ROE得分：75分（权重25%）
  - 营收增长得分：70分（权重20%）
  - 利润增长得分：80分（权重15%）
  - 基本面得分 = 90×0.2 + 85×0.2 + 75×0.25 + 70×0.2 + 80×0.15 = 80.25分

- 成交量评分：85分
  - 量比得分：90分（权重40%）
  - 换手率得分：85分（权重30%）
  - 成交量趋势得分：80分（权重30%）
  - 成交量得分 = 90×0.4 + 85×0.3 + 80×0.3 = 85.5分

- 价格评分：75分
  - 价格趋势得分：80分（权重35%）
  - 价格位置得分：70分（权重30%）
  - 波动率得分：75分（权重35%）
  - 价格得分 = 80×0.35 + 70×0.30 + 75×0.35 = 75.25分

**总评分** = 80.25×0.4 + 85.5×0.3 + 75.25×0.3 = 32.1 + 25.65 + 22.575 = 80.325分

---

## 缺失指标处理

程序采用**智能容错机制**处理缺失指标：

### 处理策略

1. **缺失数据时**：使用默认中等分（50分）参与计算
2. **所有股票都缺失某个维度时**：自动将该维度权重设为0，并重新归一化其他权重
3. **部分股票缺失数据时**：缺失数据的股票使用默认分，不影响其他股票评分

### 各维度缺失指标的处理

#### 基本面数据缺失

- **PE/PB/ROE/增长率缺失时**：使用默认分50分
- **所有股票都缺失基本面数据**：基本面权重设为0，其他权重重新归一化

#### 财务数据缺失

- **ROE/增长率缺失时**：使用默认分50分
- **所有股票都缺失财务数据**：财务相关权重会从基本面权重中移除，其他权重重新归一化

#### 成交量数据缺失

- **量比/换手率/成交量趋势缺失时**：使用默认分50分
- **所有股票都缺失成交量数据**：成交量权重设为0，其他权重重新归一化

#### 价格数据缺失

- **价格趋势/位置/波动率缺失时**：使用默认分50分
- **所有股票都缺失价格数据**：价格权重设为0，其他权重重新归一化

### 权重调整示例

假设原始权重配置为：
- 基本面：40%
- 成交量：30%
- 价格：30%

如果所有股票都缺失价格数据，程序会自动调整权重：
- 基本面：40% / (40% + 30%) = 57.14%
- 成交量：30% / (40% + 30%) = 42.86%
- 价格：0%（已移除）

---

## 分数范围与等级

### 分数范围

- **各维度得分**：0-100分
- **综合得分**：0-100分

### 评分等级

| 分数范围 | 等级 | 说明 |
|---------|------|------|
| 85分以上 | 优秀 | 各项指标表现优秀，值得重点关注 |
| 75-84分 | 良好 | 各项指标表现良好，可以关注 |
| 65-74分 | 一般 | 各项指标表现一般，需要进一步分析 |
| 65分以下 | 较差 | 各项指标表现较差，建议谨慎考虑 |

### 评分说明

程序运行后会显示详细的评分说明，包括：

- **采用的评分维度及权重**
- **各维度的子维度**
- **缺失指标提示**（如果有）
- **总评分计算公式**

示例输出：
```
【最终打分维度说明】
------------------------------------------------------------
采用的评分维度及权重：
  ✓ 基本面评分: 40.0%
    └─ 子维度: PE市盈率, PB市净率, ROE净资产收益率, 营收增长率, 利润增长率
  ✓ 成交量评分: 30.0%
    └─ 子维度: 量比, 换手率, 成交量趋势
  ✓ 价格评分: 30.0%
    └─ 子维度: 价格趋势, 价格位置, 波动率

【缺失指标提示】
------------------------------------------------------------
  ⚠ 财务数据未采用（数据不可用或权重已调整）
    原因: 财务数据（ROE、增长率）缺失或无效

============================================================
【评分说明】
------------------------------------------------------------
总评分 = 基本面评分 × 40.0% + 成交量评分 × 30.0% + 价格评分 × 30.0%
============================================================
```

---

## 相关文档

- [参数配置文档](configuration.md) - 权重配置方法
- [Tushare积分文档](tushare.md) - 数据获取和积分要求

